<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TOEFL 2026: Sequential Task Practice</title>
    <style>
        body { font-family: 'Arial', sans-serif; line-height: 1.8; padding: 40px; background: #f4f4f9; color: #333; }
        .container { max-width: 800px; margin: auto; background: white; padding: 40px; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        h2 { color: #00467f; margin-top: 0; font-size: 1.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .instructions { font-size: 0.95rem; color: #666; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .text-block { font-size: 1.3rem; word-spacing: 3px; }
        input { border: none; border-bottom: 1px solid #333; width: auto; font-size: 1.2rem; text-align: center; font-family: 'Courier New', monospace; outline: none; padding: 0; margin: 0 1px; background: #fffde7; }
        .correct { background: #e8f5e9; border-bottom: 2px solid #2e7d32; color: #2e7d32; }
        .wrong { background: #ffebee; border-bottom: 2px solid #c62828; color: #c62828; }
        .btn-group { margin-top: 30px; display: flex; gap: 10px; }
        button { padding: 10px 20px; cursor: pointer; border: 1px solid #00467f; background: #00467f; color: white; font-weight: bold; border-radius: 3px; }
        button:disabled { background: #ccc; border-color: #ccc; cursor: not-allowed; }
        #result { margin-top: 20px; font-weight: bold; font-size: 1.2rem; }
        .progress { font-size: 0.8rem; color: #999; margin-bottom: 5px; }
    </style>
</head>
<body>

<div class="container">
    <div class="progress" id="progressTracker">Passage 1 of 5</div>
    <h2>Reading Task: Complete the Word</h2>
    <p class="instructions">Read the passage. Complete the words by typing the missing letters. Each underscore represents one letter.</p>
    
    <div id="exercise" class="text-block"></div>

    <div class="btn-group">
        <button onclick="checkAnswers()">Check Answers</button>
        <button id="nextBtn" onclick="nextPassage()" style="background: #666; border-color: #666;">Next Passage</button>
    </div>
    <div id="result"></div>
</div>

<script>
    const bank = [
        "Deep-sea organisms have evolved unique ways to survive in the absolute darkness of the ocean floor. Many creatures use bioluminescence to attract prey or communicate with mates. This chemical reaction produces light without generating heat.",
        "The principle of supply and demand serves as the fundamental backbone of modern market economies. When demand for a product rises, prices normally increase unless supply also expands. Conversely, an overabundance of goods often leads to a decrease.",
        "Rising global temperatures have led to the rapid melting of polar ice caps and mountain glaciers. This phenomenon contributes directly to rising sea levels worldwide. Scientists predict that coastal cities may face severe flooding within decades.",
        "The Silk Road was an ancient network of trade routes that connected the East and the West. It facilitated not only the exchange of goods but also the spread of ideas. Cultural traditions and technological innovations traveled across many miles.",
        "Cognitive dissonance occurs when an individual holds two or more contradictory beliefs or values. Most people feel psychological discomfort when their actions do not align with their personal ethics. To reduce tension, individuals often justify their behavior."
    ];

    let currentIndex = 0;

    function displayExercise(index) {
        const fullText = bank[index];
        const exerciseDiv = document.getElementById('exercise');
        const progressTracker = document.getElementById('progressTracker');
        document.getElementById('result').innerHTML = "";
        progressTracker.innerText = `Passage ${index + 1} of ${bank.length}`;
        
        // Split text into first sentence and the rest
        const sentences = fullText.match(/[^\.!\?]+[\.!\?]+/g);
        const firstSentence = sentences[0];
        const remainingText = sentences.slice(1).join(" ");
        const words = remainingText.trim().split(/\s+/);
        
        let formattedHTML = firstSentence + " ";
        let missingCount = 0;

        words.forEach((word, wordIdx) => {
            // Rule: Every second word (index 1, 3, 5...) and cap at 10 missing words
            if (wordIdx % 2 === 1 && missingCount < 10) {
                const cleanWord = word.replace(/[,\.]/g, '');
                const punctuation = word.replace(/[a-zA-Z]/g, '');
                
                const keepLength = Math.ceil(cleanWord.length / 2);
                const missingLength = cleanWord.length - keepLength;
                
                const stem = cleanWord.substring(0, keepLength);
                const answer = cleanWord.substring(keepLength);
                
                // One underscore per missing letter
                const underscores = "_".repeat(missingLength);
                
                formattedHTML += `${stem}<input type="text" data-answer="${answer}" maxlength="${missingLength}" style="width: ${missingLength * 18}px" placeholder="${underscores}">${punctuation} `;
                missingCount++;
            } else {
                formattedHTML += word + " ";
            }
        });

        exerciseDiv.innerHTML = formattedHTML;
        
        // Disable "Next" if we are at the end
        document.getElementById('nextBtn').disabled = (index === bank.length - 1);
    }

    function checkAnswers() {
        const inputs = document.querySelectorAll('input');
        let score = 0;
        inputs.forEach(input => {
            if (input.value.toLowerCase().trim() === input.getAttribute('data-answer').toLowerCase()) {
                input.className = 'correct';
                score++;
            } else {
                input.className = 'wrong';
            }
        });
        document.getElementById('result').innerHTML = `Score: ${score} / ${inputs.length}`;
    }

    function nextPassage() {
        if (currentIndex < bank.length - 1) {
            currentIndex++;
            displayExercise(currentIndex);
        }
    }

    // Load the first one on start
    displayExercise(currentIndex);
</script>

</body>
</html>
