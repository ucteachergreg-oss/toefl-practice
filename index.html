<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TOEFL iBT 2026: Reading Practice</title>
    <style>
        body { font-family: 'Arial', sans-serif; line-height: 1.8; padding: 40px; background: #f4f4f9; color: #333; }
        .container { max-width: 800px; margin: auto; background: white; padding: 40px; border: 1px solid #ddd; border-radius: 4px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        h2 { color: #00467f; margin-top: 0; font-size: 1.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .instructions { font-size: 0.95rem; color: #666; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .text-block { font-size: 1.3rem; word-spacing: 3px; }
        
        .word-unit {
            white-space: nowrap;
            display: inline-block;
        }

        input { 
            border: none; 
            background: transparent;
            font-size: 1.2rem; 
            text-align: left; 
            font-family: 'Courier New', monospace; 
            outline: none; 
            padding: 0; 
            margin: 0;
            color: #2c3e50;
            letter-spacing: 4px; 
            display: inline-block;
            vertical-align: baseline;
        }
        
        input::placeholder {
            color: #333;
            opacity: 1;
        }

        input:focus { 
            background: #fff9c4; 
        }

        .correct { 
            color: #2e7d32 !important; 
            font-weight: bold; 
            background: #e8f5e9 !important; 
            letter-spacing: normal; 
        }

        .wrong { 
            color: #c62828 !important; 
            font-weight: bold; 
            background: #ffebee !important; 
            letter-spacing: normal;
        }

        .btn-group { margin-top: 30px; display: flex; gap: 10px; }
        button { padding: 10px 20px; cursor: pointer; border: 1px solid #00467f; background: #00467f; color: white; font-weight: bold; border-radius: 3px; }
        button:disabled { background: #ccc; border-color: #ccc; cursor: not-allowed; }
        #result { margin-top: 20px; font-weight: bold; font-size: 1.2rem; }
        .progress { font-size: 0.8rem; color: #999; margin-bottom: 5px; }
        
        .summary-card { text-align: center; padding: 20px; background: #eef2f7; border-radius: 8px; }
        .summary-score { font-size: 3rem; color: #00467f; display: block; margin: 10px 0; }
    </style>
</head>
<body>

<div class="container" id="mainContainer">
    <div class="progress" id="progressTracker">Passage 1 of 5</div>
    <h2>Reading Task: Complete the Word</h2>
    <div class="instructions" id="instructionText">Read the passage. Complete the words by typing the missing letters. Each underscore represents one letter.</div>
    
    <div id="exercise" class="text-block"></div>

    <div class="btn-group" id="controls">
        <button id="checkBtn" onclick="checkAnswers()">Check Answers</button>
        <button id="nextBtn" onclick="nextPassage()">Next Passage</button>
    </div>
    <div id="result"></div>
</div>

<script>
    const bank = [
        "Deep-sea organisms have evolved unique ways to survive in the absolute darkness of the ocean floor. Many creatures use bioluminescence to attract prey or communicate with mates. This chemical reaction produces light without generating heat.",
        "The principle of supply and demand serves as the fundamental backbone of modern market economies. When demand for particular products rises, prices normally increase unless supply also expands. Conversely, an overabundance of goods often leads to a decrease.",
        "Rising global temperatures have led to the rapid melting of polar ice caps and mountain glaciers. This phenomenon contributes directly to rising sea levels worldwide. Scientists predict that coastal cities may face severe flooding within decades.",
        "The Silk Road was an ancient network of trade routes that connected the East and the West. It facilitated not only the exchange of goods but also the spread of ideas. Cultural traditions and technological innovations traveled across many miles.",
        "Cognitive dissonance occurs when an individual holds two or more contradictory beliefs or values. Most people feel psychological discomfort when their actions do not align with their personal ethics. To reduce tension, individuals often justify their behavior."
    ];

    let currentIndex = 0;
    let totalScore = 0;
    let totalPossible = 0;
    let hasChecked = false;

    function displayExercise(index) {
        const fullText = bank[index];
        const exerciseDiv = document.getElementById('exercise');
        const progressTracker = document.getElementById('progressTracker');
        document.getElementById('result').innerHTML = "";
        progressTracker.innerText = `Passage ${index + 1} of ${bank.length}`;
        hasChecked = false;
        document.getElementById('checkBtn').disabled = false;
        
        const sentences = fullText.match(/[^\.!\?]+[\.!\?]+/g);
        const firstSentence = sentences[0];
        const remainingText = sentences.slice(1).join(" ");
        const words = remainingText.trim().split(/\s+/);
        
        let formattedHTML = firstSentence + " ";
        let missingCount = 0;

        words.forEach((word, wordIdx) => {
            if (wordIdx % 2 === 1 && missingCount < 10) {
                const cleanWord = word.replace(/[,\.]/g, '');
                const punctuation = word.replace(/[a-zA-Z]/g, '');
                const keepLength = Math.ceil(cleanWord.length / 2);
                const missingLength = cleanWord.length - keepLength;
                const stem = cleanWord.substring(0, keepLength);
                const answer = cleanWord.substring(keepLength);
                const underscores = "_".repeat(missingLength);
                const calculatedWidth = (missingLength * 16) + 5;
                
                formattedHTML += `<span class="word-unit">${stem}<input type="text" 
                                    data-answer="${answer}" 
                                    maxlength="${missingLength}" 
                                    style="width: ${calculatedWidth}px" 
                                    placeholder="${underscores}"></span>${punctuation} `;
                missingCount++;
            } else {
                formattedHTML += word + " ";
            }
        });

        exerciseDiv.innerHTML = formattedHTML;
        document.getElementById('nextBtn').style.display = "none";
    }

    function checkAnswers() {
        if(hasChecked) return;
        const inputs = document.querySelectorAll('input');
        let currentPassageScore = 0;
        
        inputs.forEach(input => {
            if (input.value.toLowerCase().trim() === input.getAttribute('data-answer').toLowerCase()) {
                input.className = 'correct';
                currentPassageScore++;
            } else {
                input.className = 'wrong';
            }
            input.disabled = true;
        });

        totalScore += currentPassageScore;
        totalPossible += inputs.length;
        hasChecked = true;
        
        document.getElementById('result').innerHTML = `Passage Score: ${currentPassageScore} / ${inputs.length}`;
        document.getElementById('checkBtn').disabled = true;
        document.getElementById('nextBtn').style.display = "inline-block";
        
        if (currentIndex === bank.length - 1) {
            document.getElementById('nextBtn').innerText = "Finish & See Summary";
        }
    }

    function nextPassage() {
        if (currentIndex < bank.length - 1) {
            currentIndex++;
            displayExercise(currentIndex);
        } else {
            showSummary();
        }
    }

    function showSummary() {
        const container = document.getElementById('mainContainer');
        const percentage = Math.round((totalScore / totalPossible) * 100);
        
        container.innerHTML = `
            <h2>Practice Complete</h2>
            <div class="summary-card">
                <p>Great job! You have completed all practice passages.</p>
                <span class="summary-score">${totalScore} / ${totalPossible}</span>
                <p>Overall Accuracy: <strong>${percentage}%</strong></p>
                <button onclick="location.reload()">Restart Practice</button>
            </div>
        `;
    }

    displayExercise(currentIndex);
</script>

</body>
</html>
